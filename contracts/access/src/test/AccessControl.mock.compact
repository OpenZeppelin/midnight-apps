pragma language_version >= 0.14.0;

import CompactStandardLibrary;

import "../interfaces/IAccessControl";
import "../AccessControl" prefix AccessControl_;

// Export circuits for testing purposes
export { 
    AccessControl_hashUserRole,
    roleCommits,
    isInitialized,
    index
};

/**
 * @description Constructs the contract by initializing the AccessControl module with an initial admin.
 * @param {ZswapCoinPublicKey} initialAdmin - The public key of the initial admin.
 * @returns {[]} - An empty array indicating successful initialization.
 * @throws {RoleError} - If the contract is already initialized (inherited from AccessControl).
 */
constructor(initialAdmin: ZswapCoinPublicKey) {
    return AccessControl_initialize(initialAdmin);
}

/**
 * @description Test circuit to grant a role to a user, wrapping AccessControl's grantRole.
 * @param {ZswapCoinPublicKey} user - The public key of the user to grant the role to.
 * @param {Role} role - The role to grant (Admin, Lp, Trader, or None).
 * @returns {[]} - An empty array indicating success.
 * @throws {RoleError} - If the contract is not initialized, caller is not Admin, or the role tree is full.
 */
export circuit testGrantRole(user: ZswapCoinPublicKey, role: Role): [] {
    return AccessControl_grantRole(user, role);
}

export circuit revokeRole(user: ZswapCoinPublicKey, role: Role, index: Uint<64>): [] {
    return AccessControl_revokeRole(user, role, index);
}
